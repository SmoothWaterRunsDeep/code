# `vscode`的配置

1. C/C++ 是需要先编译的语言，要确保 `preLaunchTask` 配置了正确的构建任务，否则它会一直报``preLaunchTask：“xxxxx”已终止，返回代码为-1”``

很多人推荐使用code runner这个插件，安装之后确实右键就能跑出代码了，但是如果用`vscode`原生的运行方式还是会报错。看起来好像是编译器的问题，其实不是，所以不用再去下载其它的编译器，就是一些环境的问题。**Code Runner** 插件通常直接运行代码，不依赖于` VSCode `的调试配置，因此其运行比较简单。但当你使用调试功能时，`VSCode` 会根据 `launch.json` 配置文件来进行调试。若调试配置没有正确设置，可能会导致调试无法正常启动。

首先正确的``task.json``可以如下配置，一般系统都会自动帮你生成,如果真的误删了或者弄乱了可以参考下面这段代码，这里编译器选用的是``mingw``

```json
{
    "version": "2.0.0",
    "tasks": [
        {
            "type": "cppbuild",  
            "label": "C/C++: g++.exe build active file",
            "command": "g++.exe",//这个字段是这个文件里最重要的一个字段，可以参考我的
            //"command": "C:\\mingw64\\bin\\g++.exe",其中要保证C:\\mingw64\\bin是已经添加到系统变量里的，添加完之后可以win+r进入cmd然后输入g++ -v来检测系统是否能找到编译器
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}\\${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ]
}
```

初始时如果想自己调出``task.json``文件也可以如下操作：

- 打开命令面板（快捷键 `Ctrl + Shift + P`），输入 “Tasks: Configure Default Build Task” 并选择该命令。
- 在弹出的选项中选择 ``“C/C++: g++.exe build active file”``（如果你使用的是 ``MinGW`` 编译器）。
- ``VSCode ``会在 `.vscode` 文件夹下生成 `tasks.json` 文件



然后可以点击``vscode``的左边框中的运行与调试，点击绿色字段创建``launch.json``文件,点进该文件点击空白处应该会弹出多个选项让你选择，选择`gdb(启动)`即可，然后会自动帮你填充相应的字段。同理，如果弄乱了这个文件或者没有弹出选项让你选择，也可以自行编辑，对于C/C++语言参考如下：

```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "g++.exe - Build and debug active file",// 任务名称
            "type": "cppdbg",
            "request": "launch",
            "program": "${fileDirname}\\${fileBasenameNoExtension}.exe",//这个字段一般不需要动，即使你是不同的电脑也不需要动
            "args": [],
            "stopAtEntry": false,
            "cwd": "${fileDirname}",
            "environment": [],
            "externalConsole": false,//这个字段可以改为true，然后在运行或调试的时候就能看到小黑框了，建议打开，因为在调试时终端可能会禁止你的输入，用小黑框相对方便一点
            "MIMode": "gdb",
            "miDebuggerPath": "gdb.exe",//这里要在gdb.exe前面补充上你加入系统变量的那个路径，以我的为例， "miDebuggerPath": "C:\\mingw64\\bin\\gdb.exe",  如果路径错误，调试时会因为找不到调试器而报错
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Set Disassembly Flavor to Intel",
                    "text": "-gdb-set disassembly-flavor intel",
                    "ignoreFailures": true
                }
            ],
            "preLaunchTask": "C/C++: g++.exe build active file"//注意，有可能vscode自动给你生成的没有这个字段，如果没有这个字段那么你每次调试的时候都会报错，因为launch.json这个文件就是负责你的调试相关的配置的
        }
    ]
}
```

**`task.json`文件和`launch.json`配置好之后，要注意的是`task.json`文件里的`“label”`字段的内容一定要和`"launch.json"`中的`“preLaunchTsak”`字段的内容一致。`preLaunchTask` 被设置为 `"C/C++: g++.exe build active file"`，这表示在启动调试器之前，会先执行 `tasks.json` 中名为 `"C/C++: g++.exe build active file"` 的任务，即编译代码。使用 `preLaunchTask` 可以确保在调试之前，项目已经被正确编译，避免在调试过程中遇到找不到可执行文件的问题。**

做完这个操作，就解决了`C/C++：g++.exe生成活动文件已终止，代码为-1`这个报错



2.有关系统变量的问题

如果使用`vscode`界面的右上角的三角形按钮运行程序时出现如下这种报错

```powershell
正在启动生成...
cmd /c chcp 65001>nul && F:\MinGW\MinGW64\bin\g++.exe -fdiagnostics-color=always -g E:\Vscode_code\1\1.cpp -o E:\Vscode_code\1\1.exe
'cmd' �����ڲ����ⲿ���Ҳ���ǿ����еĳ���
���������ļ���

生成已完成，但出现错误。
```

错误信息 �����ڲ����ⲿ���Ҳ���ǿ����еĳ���表明系统找不到 `cmd` 命令。

`cmd.exe` 是 Windows 系统的命令行解释器，系统找不到 `cmd` 命令，很可能是因为系统的 `PATH` 环境变量配置存在问题，导致系统无法找到 `cmd.exe` 的路径。

==解决方法==：把`C:\Windows\System32`这个路径添加到系统变量path即可。



3.

遇到如下报错并不常见，但是遇到也没关系，很好解决，这可能是因为你之前的任务还没结束又运行了一个程序

```powershell
cmd /c chcp 65001>nul && F:\MinGW\MinGW64\bin\g++.exe -fdiagnostics-color=always -g E:\Vscode_code\1\1.cpp -o E:\Vscode_code\1\1.exe
F:/MinGW/MinGW64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot open output file E:\Vscode_code\1\1.exe: Permission denied
collect2.exe: error: ld returned 1 exit status
```

其中报错信息：`F:/MinGW/MinGW64/bin/../lib/gcc/x86_64-w64-mingw32/14.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot open output file E:\Vscode_code\1\1.exe: Permission denied` 可以知道，在编译过程中，链接器（`ld.exe`）无法打开输出文件 `E:\Vscode_code\1\1.exe`，原因是权限被拒绝。

**原因**

`1.exe` 文件可能正在被其他程序占用，比如该程序正在运行，或者被某个文件查看器、编辑器等工具打开，这就导致编译器无法对其进行覆盖写入。

**解决办法**

- **关闭正在运行的程序**：在任务管理器中查找 `1.exe` 进程，如果存在，将其结束。在 Windows 系统中，按下 `Ctrl + Shift + Esc` 组合键打开任务管理器，在 “进程” 选项卡中找到相关进程，然后点击 “结束任务”。
- **关闭占用文件的应用**：检查是否有其他应用程序正在使用 `1.exe` 文件，比如文件资源管理器中可能存在对该文件的打开状态，关闭相关应用后再尝试编译。



4.

对了，还有就是插件的问题，比如在配置`marscode AI`助手的时候需要登录，有些人可能一直会在`vscode`的右下角那里转圈，出现登录超时的现象，看起来就好像网速很慢的感觉一样，这种情况打开Windows的设置，调整一下默认应用里的浏览器设置，不要把默认浏览器设置为谷歌浏览器，换成微软自带的浏览或者其他浏览器就可以了。另外如果想登录`vscode`里的`GitHub Copilot`助手需要登录`Github`，可能会出现网站重定向导致的浏览器提示风险，这种情况可以考虑关系